<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.key.dwsurvey.mapper.QuestionMapper" >
  <resultMap id="BaseResultMap" type="com.key.dwsurvey.entity.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="answer_input_row" property="answerInputRow" jdbcType="INTEGER" />
    <result column="answer_input_width" property="answerInputWidth" jdbcType="INTEGER" />
    <result column="belong_id" property="belongId" jdbcType="VARCHAR" />
    <result column="cell_count" property="cellCount" jdbcType="INTEGER" />
    <result column="check_type" property="checkType" javaType="com.key.common.CheckType"  typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
    <result column="contacts_attr" property="contactsAttr" jdbcType="INTEGER" />
    <result column="contacts_field" property="contactsField" jdbcType="VARCHAR" />
    <result column="copy_from_id" property="copyFromId" jdbcType="VARCHAR" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="hv" property="hv" jdbcType="INTEGER" />
    <result column="is_required" property="isRequired" jdbcType="INTEGER" />
    <result column="keywords" property="keywords" jdbcType="VARCHAR" />
    <result column="order_by_id" property="orderById" jdbcType="INTEGER" />
    <result column="param_int01" property="paramInt01" jdbcType="INTEGER" />
    <result column="param_int02" property="paramInt02" jdbcType="INTEGER" />
    <result column="parent_qu_id" property="parentQuId" jdbcType="VARCHAR" />
    <result column="qu_name" property="quName" jdbcType="VARCHAR" />
    <result column="qu_tag" property="quTag" jdbcType="INTEGER" />
    <result column="qu_type" property="quType" javaType="com.key.common.QuType" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
    <result column="rand_order" property="randOrder" jdbcType="INTEGER" />
    <result column="tag" property="tag" jdbcType="INTEGER" />
    <result column="visibility" property="visibility" jdbcType="INTEGER" />
    <result column="yesno_option" property="yesnoOption" jdbcType="INTEGER" />
    <result column="qu_note" property="quNote" jdbcType="LONGVARCHAR" />
    <result column="qu_title" property="quTitle" jdbcType="LONGVARCHAR" />
  </resultMap>
  <parameterMap id="ResultMap" type="com.key.dwsurvey.entity.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <parameter  property="id" jdbcType="VARCHAR" />
    <parameter  property="answerInputRow" jdbcType="INTEGER" />
    <parameter  property="answerInputWidth" jdbcType="INTEGER" />
    <parameter  property="belongId" jdbcType="VARCHAR" />
    <parameter  property="cellCount" jdbcType="INTEGER" />
    <parameter  property="checkType" javaType="com.key.common.CheckType"  typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
    <parameter property="contactsAttr" jdbcType="INTEGER" />
    <parameter property="contactsField" jdbcType="VARCHAR" />
    <parameter property="copyFromId" jdbcType="VARCHAR" />
    <parameter property="createDate" jdbcType="TIMESTAMP" />
    <parameter  property="hv" jdbcType="INTEGER" />
    <parameter  property="isRequired" jdbcType="INTEGER" />
    <parameter  property="keywords" jdbcType="VARCHAR" />
    <parameter  property="orderById" jdbcType="INTEGER" />
    <parameter  property="paramInt01" jdbcType="INTEGER" />
    <parameter  property="paramInt02" jdbcType="INTEGER" />
    <parameter property="parentQuId" jdbcType="VARCHAR" />
    <parameter  property="quName" jdbcType="VARCHAR" />
    <parameter  property="quTag" jdbcType="INTEGER" />
    <parameter  property="quType" javaType="com.key.common.QuType" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>
    <parameter  property="randOrder" jdbcType="INTEGER" />
    <parameter  property="tag" jdbcType="INTEGER" />
    <parameter property="visibility" jdbcType="INTEGER" />
    <parameter  property="yesnoOption" jdbcType="INTEGER" />
    <parameter  property="quNote" jdbcType="LONGVARCHAR" />
    <parameter  property="quTitle" jdbcType="LONGVARCHAR" />
  </parameterMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, answer_input_row, answer_input_width, belong_id, cell_count, check_type, contacts_attr, 
    contacts_field, copy_from_id, create_date, hv, is_required, keywords, order_by_id, 
    param_int01, param_int02, parent_qu_id, qu_name, qu_tag, qu_type, rand_order, tag, 
    visibility, yesno_option
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    qu_note, qu_title
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    *
    from t_question
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from t_question
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.key.dwsurvey.entity.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into t_question (id, answer_input_row, answer_input_width, 
      belong_id, cell_count, check_type, 
      contacts_attr, contacts_field, copy_from_id, 
      create_date, hv, is_required, 
      keywords, order_by_id, param_int01, 
      param_int02, parent_qu_id, qu_name, 
      qu_tag, qu_type, rand_order, 
      tag, visibility, yesno_option, 
      qu_note, qu_title)
    values (#{id,jdbcType=VARCHAR}, #{answerInputRow,jdbcType=INTEGER}, #{answerInputWidth,jdbcType=INTEGER}, 
      #{belongId,jdbcType=VARCHAR}, #{cellCount,jdbcType=INTEGER}, #{checkType,jdbcType=INTEGER}, 
      #{contactsAttr,jdbcType=INTEGER}, #{contactsField,jdbcType=VARCHAR}, #{copyFromId,jdbcType=VARCHAR}, 
      #{createDate,jdbcType=TIMESTAMP}, #{hv,jdbcType=INTEGER}, #{isRequired,jdbcType=INTEGER}, 
      #{keywords,jdbcType=VARCHAR}, #{orderById,jdbcType=INTEGER}, #{paramInt01,jdbcType=INTEGER}, 
      #{paramInt02,jdbcType=INTEGER}, #{parentQuId,jdbcType=VARCHAR}, #{quName,jdbcType=VARCHAR}, 
      #{quTag,jdbcType=INTEGER}, #{quType,jdbcType=INTEGER}, #{randOrder,jdbcType=INTEGER}, 
      #{tag,jdbcType=INTEGER}, #{visibility,jdbcType=INTEGER}, #{yesnoOption,jdbcType=INTEGER}, 
      #{quNote,jdbcType=LONGVARCHAR}, #{quTitle,jdbcType=LONGVARCHAR})
  </insert>
  <insert id="insertSelective" parameterMap="ResultMap" useGeneratedKeys="true" keyProperty="id">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.String" keyProperty="id" order="BEFORE" >
      SELECT replace(uuid(),'-','')
    </selectKey>
    insert into t_question
    <trim prefix="(" suffix=")" suffixOverrides="," >
      id,
      <if test="answerInputRow != null" >
        answer_input_row,
      </if>
      <if test="answerInputWidth != null" >
        answer_input_width,
      </if>
      <if test="belongId != null" >
        belong_id,
      </if>
      <if test="cellCount != null" >
        cell_count,
      </if>
      <if test="checkType != null" >
        check_type,
      </if>
      <if test="contactsAttr != null" >
        contacts_attr,
      </if>
      <if test="contactsField != null" >
        contacts_field,
      </if>
      <if test="copyFromId != null" >
        copy_from_id,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="hv != null" >
        hv,
      </if>
      <if test="isRequired != null" >
        is_required,
      </if>
      <if test="keywords != null" >
        keywords,
      </if>
      <if test="orderById != null" >
        order_by_id,
      </if>
      <if test="paramInt01 != null" >
        param_int01,
      </if>
      <if test="paramInt02 != null" >
        param_int02,
      </if>
      <if test="parentQuId != null" >
        parent_qu_id,
      </if>
      <if test="quName != null" >
        qu_name,
      </if>
      <if test="quTag != null" >
        qu_tag,
      </if>
      <if test="quType != null" >
        qu_type,
      </if>
      <if test="randOrder != null" >
        rand_order,
      </if>
      <if test="tag != null" >
        tag,
      </if>
      <if test="visibility != null" >
        visibility,
      </if>
      <if test="yesnoOption != null" >
        yesno_option,
      </if>
      <if test="quNote != null" >
        qu_note,
      </if>
      <if test="quTitle != null" >
        qu_title,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      #{id,jdbcType=VARCHAR},
      <if test="answerInputRow != null" >
        #{answerInputRow,jdbcType=INTEGER},
      </if>
      <if test="answerInputWidth != null" >
        #{answerInputWidth,jdbcType=INTEGER},
      </if>
      <if test="belongId != null" >
        #{belongId,jdbcType=VARCHAR},
      </if>
      <if test="cellCount != null" >
        #{cellCount,jdbcType=INTEGER},
      </if>
      <if test="checkType != null" >
        #{checkType,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler},
      </if>
      <if test="contactsAttr != null" >
        #{contactsAttr,jdbcType=INTEGER},
      </if>
      <if test="contactsField != null" >
        #{contactsField,jdbcType=VARCHAR},
      </if>
      <if test="copyFromId != null" >
        #{copyFromId,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="hv != null" >
        #{hv,jdbcType=INTEGER},
      </if>
      <if test="isRequired != null" >
        #{isRequired,jdbcType=INTEGER},
      </if>
      <if test="keywords != null" >
        #{keywords,jdbcType=VARCHAR},
      </if>
      <if test="orderById != null" >
        #{orderById,jdbcType=INTEGER},
      </if>
      <if test="paramInt01 != null" >
        #{paramInt01,jdbcType=INTEGER},
      </if>
      <if test="paramInt02 != null" >
        #{paramInt02,jdbcType=INTEGER},
      </if>
      <if test="parentQuId != null" >
        #{parentQuId,jdbcType=VARCHAR},
      </if>
      <if test="quName != null" >
        #{quName,jdbcType=VARCHAR},
      </if>
      <if test="quTag != null" >
        #{quTag,jdbcType=INTEGER},
      </if>
      <if test="quType != null" >
        #{quType  ,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler },
      </if>
      <if test="randOrder != null" >
        #{randOrder,jdbcType=INTEGER},
      </if>
      <if test="tag != null" >
        #{tag,jdbcType=INTEGER},
      </if>
      <if test="visibility != null" >
        #{visibility,jdbcType=INTEGER},
      </if>
      <if test="yesnoOption != null" >
        #{yesnoOption,jdbcType=INTEGER},
      </if>
      <if test="quNote != null" >
        #{quNote,jdbcType=LONGVARCHAR},
      </if>
      <if test="quTitle != null" >
        #{quTitle,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.key.dwsurvey.entity.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_question
    <set >
      <if test="answerInputRow != null" >
        answer_input_row = #{answerInputRow,jdbcType=INTEGER},
      </if>
      <if test="answerInputWidth != null" >
        answer_input_width = #{answerInputWidth,jdbcType=INTEGER},
      </if>
      <if test="belongId != null" >
        belong_id = #{belongId,jdbcType=VARCHAR},
      </if>
      <if test="cellCount != null" >
        cell_count = #{cellCount,jdbcType=INTEGER},
      </if>
      <if test="checkType != null" >
        check_type = #{checkType,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler},
      </if>
      <if test="contactsAttr != null" >
        contacts_attr = #{contactsAttr,jdbcType=INTEGER},
      </if>
      <if test="contactsField != null" >
        contacts_field = #{contactsField,jdbcType=VARCHAR},
      </if>
      <if test="copyFromId != null" >
        copy_from_id = #{copyFromId,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="hv != null" >
        hv = #{hv,jdbcType=INTEGER},
      </if>
      <if test="isRequired != null" >
        is_required = #{isRequired,jdbcType=INTEGER},
      </if>
      <if test="keywords != null" >
        keywords = #{keywords,jdbcType=VARCHAR},
      </if>
      <if test="orderById != null" >
        order_by_id = #{orderById,jdbcType=INTEGER},
      </if>
      <if test="paramInt01 != null" >
        param_int01 = #{paramInt01,jdbcType=INTEGER},
      </if>
      <if test="paramInt02 != null" >
        param_int02 = #{paramInt02,jdbcType=INTEGER},
      </if>
      <if test="parentQuId != null" >
        parent_qu_id = #{parentQuId,jdbcType=VARCHAR},
      </if>
      <if test="quName != null" >
        qu_name = #{quName,jdbcType=VARCHAR},
      </if>
      <if test="quTag != null" >
        qu_tag = #{quTag,jdbcType=INTEGER},
      </if>
      <if test="quType != null" >
        qu_type = #{quType,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler},
      </if>
      <if test="randOrder != null" >
        rand_order = #{randOrder,jdbcType=INTEGER},
      </if>
      <if test="tag != null" >
        tag = #{tag,jdbcType=INTEGER},
      </if>
      <if test="visibility != null" >
        visibility = #{visibility,jdbcType=INTEGER},
      </if>
      <if test="yesnoOption != null" >
        yesno_option = #{yesnoOption,jdbcType=INTEGER},
      </if>
      <if test="quNote != null" >
        qu_note = #{quNote,jdbcType=LONGVARCHAR},
      </if>
      <if test="quTitle != null" >
        qu_title = #{quTitle,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.key.dwsurvey.entity.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_question
    set answer_input_row = #{answerInputRow,jdbcType=INTEGER},
      answer_input_width = #{answerInputWidth,jdbcType=INTEGER},
      belong_id = #{belongId,jdbcType=VARCHAR},
      cell_count = #{cellCount,jdbcType=INTEGER},
      check_type = #{checkType,jdbcType=INTEGER},
      contacts_attr = #{contactsAttr,jdbcType=INTEGER},
      contacts_field = #{contactsField,jdbcType=VARCHAR},
      copy_from_id = #{copyFromId,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      hv = #{hv,jdbcType=INTEGER},
      is_required = #{isRequired,jdbcType=INTEGER},
      keywords = #{keywords,jdbcType=VARCHAR},
      order_by_id = #{orderById,jdbcType=INTEGER},
      param_int01 = #{paramInt01,jdbcType=INTEGER},
      param_int02 = #{paramInt02,jdbcType=INTEGER},
      parent_qu_id = #{parentQuId,jdbcType=VARCHAR},
      qu_name = #{quName,jdbcType=VARCHAR},
      qu_tag = #{quTag,jdbcType=INTEGER},
      qu_type = #{quType,jdbcType=INTEGER},
      rand_order = #{randOrder,jdbcType=INTEGER},
      tag = #{tag,jdbcType=INTEGER},
      visibility = #{visibility,jdbcType=INTEGER},
      yesno_option = #{yesnoOption,jdbcType=INTEGER},
      qu_note = #{quNote,jdbcType=LONGVARCHAR},
      qu_title = #{quTitle,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.key.dwsurvey.entity.Question" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_question
    set answer_input_row = #{answerInputRow,jdbcType=INTEGER},
      answer_input_width = #{answerInputWidth,jdbcType=INTEGER},
      belong_id = #{belongId,jdbcType=VARCHAR},
      cell_count = #{cellCount,jdbcType=INTEGER},
      check_type = #{checkType,jdbcType=INTEGER},
      contacts_attr = #{contactsAttr,jdbcType=INTEGER},
      contacts_field = #{contactsField,jdbcType=VARCHAR},
      copy_from_id = #{copyFromId,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      hv = #{hv,jdbcType=INTEGER},
      is_required = #{isRequired,jdbcType=INTEGER},
      keywords = #{keywords,jdbcType=VARCHAR},
      order_by_id = #{orderById,jdbcType=INTEGER},
      param_int01 = #{paramInt01,jdbcType=INTEGER},
      param_int02 = #{paramInt02,jdbcType=INTEGER},
      parent_qu_id = #{parentQuId,jdbcType=VARCHAR},
      qu_name = #{quName,jdbcType=VARCHAR},
      qu_tag = #{quTag,jdbcType=INTEGER},
      qu_type = #{quType,jdbcType=INTEGER},
      rand_order = #{randOrder,jdbcType=INTEGER},
      tag = #{tag,jdbcType=INTEGER},
      visibility = #{visibility,jdbcType=INTEGER},
      yesno_option = #{yesnoOption,jdbcType=INTEGER}
    where id = #{id,jdbcType=VARCHAR}
  </update>


  <select id="findAll" resultMap="BaseResultMap" parameterType="map">
    select * from t_question where belong_id=#{belongId} and tag=#{tag} and qu_tag <![CDATA[<>]]> #{quTag} order by order_by_id
  </select>

  <select id="selectByparentQuUuId" resultMap="BaseResultMap" parameterType="string">
    select *from t_question where parent_qu_id=#{parentQuId}
  </select>

  <update id="quOrderByIdDel1">
    /*修改数据*/
    update t_question set order_by_id=order_by_id-1 where belong_id=#{belongId} and order_by_id>=#{orderById};
  </update>
  <select id="findByBelongIdAndTagNotInQuType" resultMap="BaseResultMap">
    SELECT id, answer_input_row, answer_input_width, belong_id, cell_count, check_type, contacts_attr,
           contacts_field, copy_from_id, create_date, hv, is_required, keywords, order_by_id,
           param_int01, param_int02, parent_qu_id, qu_name, qu_tag, qu_type, rand_order, tag,
           visibility, yesno_option
    FROM t_question
    WHERE belong_id = #{belongId} AND tag = #{tag}
      AND qu_type NOT IN
          <foreach item="item" index="index" collection="list"
                                  open="(" separator="," close=")">
             #{item}
          </foreach>
  </select>

  <update id="quOrderByIdAdd1">
    update t_question set order_by_id=order_by_id+1 where belong_id=#{belongId} and order_by_id>=#{orderById} and id != #{id}
  </update>
</mapper>